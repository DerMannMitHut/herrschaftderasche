items:
  ashen_crown:
    state: broken
    states:
      broken: {}
      repaired: {}
      destroyed: {}
      worn: {}
  flame_blade: {}

rooms:
  ash_village:
    items: []
    exits:
      - grey_forest
      - black_tower
  grey_forest:
    items:
      - flame_blade
    exits:
      - ash_village
      - black_tower
      - glow_chasm
  black_tower:
    items:
      - ashen_crown
    exits:
      - ash_village
      - grey_forest
      - glow_chasm
  glow_chasm:
    items: []
    exits:
      - grey_forest
      - black_tower

uses:
  repair_crown:
    item: flame_blade
    target_item: ashen_crown
    preconditions:
      is_location: glow_chasm
    effect:
      item_condition:
        item: ashen_crown
        state: repaired

start: ash_village

endings:
  crown_returned:
    preconditions:
      is_location: ash_village
      item_condition:
        item: ashen_crown
        location: INVENTORY
  crown_repaired:
    preconditions:
      item_condition:
        item: ashen_crown
        state: repaired
  crown_destroyed:
    preconditions:
      item_condition:
        item: ashen_crown
        state: destroyed
  crown_worn:
    preconditions:
      item_condition:
        item: ashen_crown
        state: worn
