items:
  small_key: {}
  map_fragment:
    state: unreadable
    states:
      unreadable: {}
      readable: {}
  ashen_crown: {}
  locked_chest:
    state: closed
    states:
      closed: {}
      open: {}

rooms:
  hut:
    items:
      - small_key
    exits:
      - forest
  forest:
    items:
      - map_fragment
    exits:
      - hut
      - ash_village
  ruins:
    items:
      - locked_chest
    exits:
      - forest
  ash_village:
    items: []
    exits:
      - forest

npcs:
  ashram:
    state: unknown
    states:
      unknown: {}
      met: {}
      helped: {}
    meet:
      location: forest

actions:
  open_chest:
    trigger: use
    item: small_key
    target_item: locked_chest
    preconditions:
      is_location: ruins
    effect:
      item_condition:
        - item: locked_chest
          state: open
        - item: ashen_crown
          location: ruins
  interpret_map:
    trigger: talk
    item: ashram
    preconditions:
      npc_met: ashram
      item_condition:
        item: map_fragment
        location: INVENTORY
        state: unreadable
    effect:
      item_condition:
        - item: map_fragment
          state: readable
      add_exit:
        - room: forest
          target: ruins
  open_ruins:
    trigger: use
    preconditions:
      npc_help: ashram
    effect:
      item_condition:
        - item: ashen_crown
          location: ruins

start: hut

endings:
  crown_returned:
    preconditions:
      is_location: ash_village
      item_condition:
        item: ashen_crown
        location: INVENTORY
