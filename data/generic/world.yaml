items:
  small_key: {}
  map_fragment:
    state: unreadable
    states:
      unreadable: {}
      readable: {}
  ashen_crown: {}
  locked_chest:
    state: closed
    states:
      closed: {}
      open: {}

rooms:
  hut:
    items:
      - map_fragment
    exits:
      - forest
  forest:
    items:
      - small_key
    exits:
      - hut
      - ruins
      - ash_village
  ruins:
    items:
      - locked_chest
    exits:
      - forest
  ash_village:
    items: []
    exits:
      - forest

uses:
  use_key:
    item: small_key
    target_item: locked_chest
    preconditions:
      is_location: ruins
    effect:
      item_condition:
        item: locked_chest
        state: open
  interpret_map:
    item: map_fragment
    preconditions:
      npc_met: ashram
    effect:
      item_condition:
        item: map_fragment
        state: readable
  open_ruins:
    preconditions:
      npc_help: ashram
    effect:
      item_condition:
        item: ashen_crown
        location: ruins

start: hut

endings:
  crown_returned:
    preconditions:
      is_location: ash_village
      item_condition:
        item: ashen_crown
        location: INVENTORY
